<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">

<link rel="import" href="../signup-page/registration-page.html">
<link rel="import" href="../presentations-page/presentations-page.html">
<link rel="import" href="../viewers-page/viewers-page.html">

<dom-module id="stable-app">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        display: block;
      }
      .container {
        margin: 10px;
      }
      .content {
        padding: 16px;
        max-width: 720px;
        margin-left: auto;
        margin-right: auto;
      }
    </style>
    <app-location route="{{route}}" use-hash-as-path></app-location>
    <app-route route="{{route}}" pattern="/:page" data="{{routeData}}" tail="{{tail}}"></app-route>

    <paper-drawer-panel force-narrow id="paperDrawerPanel">
      <paper-header-panel drawer>
        <paper-toolbar>
          <div>Project Stable</div>
        </paper-toolbar>
        <div>
          <paper-menu attr-for-selected="name" selected="{{routeData.page}}" on-tap="_closeDrawer">
            <paper-item name="registration">Registration</paper-item>
            <paper-item name="presentations">Presentations</paper-item>
            <paper-item name="viewers">Viewers</paper-item>
          </paper-menu>

        </div>
      </paper-header-panel>
      <paper-header-panel main>
        <paper-toolbar>
          <paper-icon-button icon="icons:menu" paper-drawer-toggle></paper-icon-button>
          <div>Project Stable [[titleText]]</div>
        </paper-toolbar>
        <div class="container">
          <div class="content">
            <iron-pages attr-for-selected="name" selected="[[routeData.page]]">
              <registration-page name="registration"></registration-page>
              <presentations-page name="presentations"></presentations-page>
              <viewers-page name="viewers"></viewers-page>
            </iron-pages>
            
          </div>
        </div>
      </paper-header-panel>
    </paper-drawer-panel>
  </template>
  <script>
    Polymer({

      is: 'stable-app',

      properties: {
        titleText: {
          type: String,
          value: ''
        },
        page: {
          type: String,
          value: 'registration',
          observer: '_onPageChanged'
        },
        routeData: {
          type: Object
        }
      },
      observers: [
      ],
      listeners: {
        'set-title': '_handleSetTitle',
        'goto-page': '_handleGotoPage'
      },
      ready: function(e) {
        
      },
      _handleSetTitle: function(e) {
        if(e && e.detail && e.detail.title) {
          this.titleText = e.detail.title;          
        } else {
          this.titleText = '';
        }
      },
      _handleGotoPage: function(e) {
        console.log(e);
        if(e && e.detail && e.detail.page) {
          this.page = e.detail.page;
        }
        console.log(this.page);
      },
      _onPageChanged: function(e) {
        console.log('changed: ' + e);
        this.set('route.path', '/' + e);
      },
      _closeDrawer: function(e) {
        this.$.paperDrawerPanel.closeDrawer();
      } 
    });
  </script>
</dom-module>
